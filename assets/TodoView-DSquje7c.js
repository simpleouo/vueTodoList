import{i as w,c as v,o as u,w as $,a as o,v as B,j as g,r as k,k as I,t as D,b as x,l as V,m as N,F as E,n as F,p as O,q as h,s as M,u as q,x as U,d as A,y as C,z as R,A as j,B as z}from"./index-CuSVTxSM.js";const P={class:"inputBox"},G={__name:"TodoForm",props:["todoTxt"],emits:["sendTodo","sendTodoTxt"],setup(l,{emit:T}){const d=l,p=T,s=()=>{p("sendTodo",a.value)},a=w({get(){return d.todoTxt},set(i){return p("sendTodoTxt",i)}});return(i,c)=>(u(),v("div",P,[$(o("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":c[0]||(c[0]=y=>a.value=y)},null,512),[[B,a.value,void 0,{trim:!0}]]),o("a",{onClick:g(s,["prevent"])},[...c[1]||(c[1]=[o("i",{class:"fa fa-plus"},null,-1)])])]))}},H=(l,T)=>{const d=l.__vccOpts||l;for(const[p,s]of T)d[p]=s;return d},J={class:"todoList_label"},K={key:0},Q={class:"control-box"},W={__name:"TodoItem",props:{todo:{type:Object,required:!0}},emits:["removeTodoTwo"],setup(l,{emit:T}){const d=l,p=T,s=k(!1),a=k(!1),i=k(d.todo.content),c=()=>{a.value||(d.todo.content=i.value),a.value=!1,s.value=!1},y=async()=>{try{const r={content:d.todo.content},n=await N(d.todo.id,r);alert(n.data.message),i.value=d.todo.content,s.value=!1}catch(r){console.log(r)}},_=async()=>{try{const r=await V(d.todo.id);alert(r.data.message)}catch(r){console.log(r)}},L=r=>{p("removeTodoTwo",r)};return(r,n)=>(u(),v("li",null,[o("label",J,[$(o("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":n[0]||(n[0]=t=>l.todo.status=t),onChange:_},null,544),[[I,l.todo.status]]),s.value?$((u(),v("input",{key:1,style:{padding:"5px"},type:"text","onUpdate:modelValue":n[1]||(n[1]=t=>l.todo.content=t),onBlur:c},null,544)),[[B,l.todo.content]]):(u(),v("span",K,D(l.todo.content),1))]),o("div",Q,[s.value?x("",!0):(u(),v("a",{key:0,onClick:n[2]||(n[2]=g(t=>s.value=!s.value,["prevent"]))},[...n[5]||(n[5]=[o("i",{class:"fa-solid fa-pen-to-square"},null,-1)])])),s.value?x("",!0):(u(),v("a",{key:1,onClick:n[3]||(n[3]=g(t=>L(l.todo.id),["prevent"]))},[...n[6]||(n[6]=[o("i",{class:"fa-solid fa-trash"},null,-1)])])),s.value?(u(),v("a",{key:2,onClick:g(y,["prevent"]),onMousedown:n[4]||(n[4]=g(t=>a.value=!0,["prevent"]))},[...n[7]||(n[7]=[o("i",{class:"fa-solid fa-check"},null,-1)])],32)):x("",!0),s.value?(u(),v("a",{key:3,onClick:g(c,["prevent"])},[...n[8]||(n[8]=[o("i",{class:"fa fa-times"},null,-1)])])):x("",!0)])]))}},X=H(W,[["__scopeId","data-v-3b66fae1"]]),Y={class:"todoList_items"},Z={class:"todoList_item"},tt={class:"todoList_statistics"},ot={__name:"TodoList",props:{todoList:{type:Array,required:!0}},emits:["removeTodoOne"],setup(l,{emit:T}){const d=l,p=T,s=w(()=>d.todoList.filter(i=>i.status==!1).length);return(a,i)=>(u(),v("div",Y,[o("ul",Z,[(u(!0),v(E,null,F(l.todoList,c=>(u(),O(X,{key:c.id,todo:c,onRemoveTodoTwo:i[0]||(i[0]=y=>p("removeTodoOne",y))},null,8,["todo"]))),128))]),o("div",tt,[o("p",null,D(s.value)+" 個待完成項目",1)])]))}},et={id:"todoListPage",class:"bg-half"},st={class:"todo_sm"},nt={href:"#"},at={class:"conatiner todoListPage vhContainer"},lt={class:"todoList_Content"},dt={class:"todoList_list"},it={class:"todoList_tab"},ut={key:1,style:{padding:"20px","text-align":"center"}},ct={__name:"TodoView",setup(l){const T=q(),d=k(""),p=k("-"),s=k("all"),a=k([]);h(async()=>{try{const t=await M(),{nickname:e,uid:m}=t.data;d.value=m,p.value=e}catch(t){console.log(t),T.push("/")}}),h(async()=>{try{const t=await U();a.value=t.data.data}catch(t){console.log(t)}});const i=t=>{s.value=t},c=async()=>{try{(await R()).data.status&&(n("vue3-todolist-token","",-1),alert("登出成功"),T.push("/"))}catch(t){console.log(t)}},y=k(""),_=async t=>{try{if(t){const m=await j({content:t}),{id:f,content:b,createTime:S}=m.data.newTodo;a.value.push({id:f,createTime:S,content:b,status:!1}),y.value=""}}catch(e){console.log(e)}},L=async t=>{try{const e=a.value.findIndex(f=>f.id==t);if(confirm(`是否刪除 "${a.value[e].content}"`)){const f=await z(t);f.data.status&&(a.value.splice(e,1),alert(f.data.message))}}catch(e){console.log(e)}},r=w(()=>{let t;return s.value=="all"?t=a.value:s.value=="todo"?t=a.value.filter(e=>e.status==!1):s.value=="done"&&(t=a.value.filter(e=>e.status==!0)),t});function n(t,e,m){const f=new Date;f.setDate(f.getDate()+m),document.cookie=`${t}=${e}; expires=${f.toUTCString()};`}return(t,e)=>(u(),v("div",et,[o("nav",null,[e[4]||(e[4]=o("h1",null,[o("a",{href:"#"},"ONLINE TODO LIST")],-1)),o("ul",null,[o("li",st,[o("a",nt,[o("span",null,D(p.value),1)])]),o("li",null,[o("a",{onClick:g(c,["prevent"])},"登出")])])]),o("div",at,[o("div",lt,[A(G,{todoTxt:y.value,onSendTodoTxt:e[0]||(e[0]=m=>y.value=m),onSendTodo:_},null,8,["todoTxt"]),o("div",dt,[o("ul",it,[o("li",null,[o("a",{onClick:e[1]||(e[1]=g(m=>i("all"),["prevent"])),class:C(s.value=="all"?"active":"")},"全部",2)]),o("li",null,[o("a",{onClick:e[2]||(e[2]=g(m=>i("todo"),["prevent"])),class:C(s.value=="todo"?"active":"")},"待完成",2)]),o("li",null,[o("a",{onClick:e[3]||(e[3]=g(m=>i("done"),["prevent"])),class:C(s.value=="done"?"active":"")},"已完成",2)])]),r.value.length?(u(),O(ot,{key:0,todoList:r.value,onRemoveTodoOne:L},null,8,["todoList"])):(u(),v("div",ut,"尚未輸入待辦事項"))])])])]))}};export{ct as default};
