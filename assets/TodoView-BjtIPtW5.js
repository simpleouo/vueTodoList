import{i as L,c as f,o as c,w as _,a as t,v as h,j as g,r as k,k as b,t as $,l as I,m as V,F,n as N,p as D,q as w,s as q,u as E,x as M,d as U,y as x,z as A,A as R,B as j}from"./index-sH3Tb1LS.js";const z={class:"inputBox"},P={__name:"TodoForm",props:["todoTxt"],emits:["sendTodo","sendTodoTxt"],setup(l,{emit:m}){const u=l,r=m,s=()=>{r("sendTodo",d.value)},d=L({get(){return u.todoTxt},set(i){return r("sendTodoTxt",i)}});return(i,v)=>(c(),f("div",z,[_(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":v[0]||(v[0]=n=>d.value=n)},null,512),[[h,d.value,void 0,{trim:!0}]]),t("a",{onClick:g(s,["prevent"])},[...v[1]||(v[1]=[t("i",{class:"fa fa-plus"},null,-1)])])]))}},G=(l,m)=>{const u=l.__vccOpts||l;for(const[r,s]of m)u[r]=s;return u},H={class:"todoList_label"},J={key:0},K={class:"control-box"},Q={__name:"TodoItem",props:{todo:{type:Object,required:!0}},emits:["removeTodoTwo"],setup(l,{emit:m}){const u=l,r=m,s=k(!1),d=async()=>{try{const n={content:u.todo.content},a=await V(u.todo.id,n);alert(a.data.message),s.value=!1}catch(n){console.log(n)}},i=async()=>{try{const n=await I(u.todo.id);alert(n.data.message)}catch(n){console.log(n)}},v=n=>{r("removeTodoTwo",n)};return(n,a)=>(c(),f("li",null,[t("label",H,[_(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=y=>l.todo.status=y),onChange:i},null,544),[[b,l.todo.status]]),s.value?_((c(),f("input",{key:1,style:{padding:"5px"},type:"text","onUpdate:modelValue":a[1]||(a[1]=y=>l.todo.content=y)},null,512)),[[h,l.todo.content]]):(c(),f("span",J,$(l.todo.content),1))]),t("div",K,[s.value?(c(),f("a",{key:1,onClick:g(d,["prevent"])},[...a[5]||(a[5]=[t("i",{class:"fa-solid fa-check"},null,-1)])])):(c(),f("a",{key:0,onClick:a[2]||(a[2]=g(y=>s.value=!s.value,["prevent"]))},[...a[4]||(a[4]=[t("i",{class:"fa-solid fa-pen-to-square"},null,-1)])])),t("a",{onClick:a[3]||(a[3]=g(y=>v(l.todo.id),["prevent"]))},[...a[6]||(a[6]=[t("i",{class:"fa fa-times"},null,-1)])])])]))}},W=G(Q,[["__scopeId","data-v-4e505286"]]),X={class:"todoList_items"},Y={class:"todoList_item"},Z={class:"todoList_statistics"},tt={__name:"TodoList",props:{todoList:{type:Array,required:!0}},emits:["removeTodoOne"],setup(l,{emit:m}){const u=l,r=m,s=L(()=>u.todoList.filter(i=>i.status==!0).length);return(d,i)=>(c(),f("div",X,[t("ul",Y,[(c(!0),f(F,null,N(l.todoList,v=>(c(),D(W,{key:v.id,todo:v,onRemoveTodoTwo:i[0]||(i[0]=n=>r("removeTodoOne",n))},null,8,["todo"]))),128))]),t("div",Z,[t("p",null,$(s.value)+" 個已完成項目",1)])]))}},ot={id:"todoListPage",class:"bg-half"},et={class:"todo_sm"},st={href:"#"},nt={class:"conatiner todoListPage vhContainer"},at={class:"todoList_Content"},lt={class:"todoList_list"},dt={class:"todoList_tab"},it={key:1,style:{padding:"20px","text-align":"center"}},ct={__name:"TodoView",setup(l){const m=E(),u=k(""),r=k("-"),s=k("all"),d=k([]);w(async()=>{try{const o=await q(),{nickname:e,uid:p}=o.data;u.value=p,r.value=e}catch(o){console.log(o),m.push("/")}}),w(async()=>{try{const o=await M();d.value=o.data.data}catch(o){console.log(o)}});const i=o=>{s.value=o},v=async()=>{try{(await A()).data.status&&(O("vue3-todolist-token","",-1),alert("登出成功"),m.push("/"))}catch(o){console.log(o)}},n=k(""),a=async o=>{try{if(o){const p=await R({content:o}),{id:T,content:B,createTime:S}=p.data.newTodo;d.value.push({id:T,createTime:S,content:B,status:!1}),n.value=""}}catch(e){console.log(e)}},y=async o=>{try{const e=d.value.findIndex(T=>T.id==o);if(confirm(`是否刪除 "${d.value[e].content}"`)){const T=await j(o);T.data.status&&(d.value.splice(e,1),alert(T.data.message))}}catch(e){console.log(e)}},C=L(()=>{let o;return s.value=="all"?o=d.value:s.value=="todo"?o=d.value.filter(e=>e.status==!1):s.value=="done"&&(o=d.value.filter(e=>e.status==!0)),o});function O(o,e,p){const T=new Date;T.setDate(T.getDate()+p),document.cookie=`${o}=${e}; expires=${T.toUTCString()};`}return(o,e)=>(c(),f("div",ot,[t("nav",null,[e[4]||(e[4]=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",et,[t("a",st,[t("span",null,$(r.value),1)])]),t("li",null,[t("a",{onClick:g(v,["prevent"])},"登出")])])]),t("div",nt,[t("div",at,[U(P,{todoTxt:n.value,onSendTodoTxt:e[0]||(e[0]=p=>n.value=p),onSendTodo:a},null,8,["todoTxt"]),t("div",lt,[t("ul",dt,[t("li",null,[t("a",{onClick:e[1]||(e[1]=g(p=>i("all"),["prevent"])),class:x(s.value=="all"?"active":"")},"全部",2)]),t("li",null,[t("a",{onClick:e[2]||(e[2]=g(p=>i("todo"),["prevent"])),class:x(s.value=="todo"?"active":"")},"待完成",2)]),t("li",null,[t("a",{onClick:e[3]||(e[3]=g(p=>i("done"),["prevent"])),class:x(s.value=="done"?"active":"")},"已完成",2)])]),C.value.length?(c(),D(tt,{key:0,todoList:C.value,onRemoveTodoOne:y},null,8,["todoList"])):(c(),f("div",it,"尚未輸入待辦事項"))])])])]))}};export{ct as default};
